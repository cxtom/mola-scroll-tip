{"version":3,"sources":["ScrollTip.js"],"names":["easeInOutQuad","t","b","c","d","raf","window","requestAnimationFrame","webkitRequestAnimationFrame","mozRequestAnimationFrame","callback","setTimeout","bind","Date","now","ScrollTip","args","state","show","onScroll","onClick","loop","done","timeStart","distance","componentDidMount","props","document","getElementsByTagName","clientWidth","addEventListener","componentWillReceiveProps","nextProps","componentWillUnmount","removeEvent","removeEventListener","e","scrollTop","documentElement","body","setState","scrollTo","timeCurrent","duration","startY","timeElapsed","next","render","className","style","color","text","height","fontSize","clickScroll","lineHeight","borderTopColor","displayName","propTypes","oneOfType","number","string","isRequired","bool","defaultProps"],"mappings":"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","file":"ScrollTip.js","sourcesContent":["/**\n * @file 滑动提示组件\n * @author cxtom <cxtom2008@gmail.com>\n */\n\nimport React, {Component, PropTypes} from 'react';\n\nimport {\n    px2rem,\n    WINDOW_WIDTH,\n    registerComponent\n} from 'mola';\n\nimport cx from 'classnames';\n\nimport {level, type} from './constants';\n\nfunction easeInOutQuad(t, b, c, d) {\n    t /= d / 2;\n    if (t < 1) {\n        return c / 2 * t * t + b;\n    }\n    t--;\n    return -c / 2 * (t * (t - 2) - 1) + b;\n}\n\nconst raf = window ? (window.requestAnimationFrame\n    || window.webkitRequestAnimationFrame\n    || window.mozRequestAnimationFrame\n    || function (callback) {\n        window.setTimeout(callback.bind(null, Date.now()), 1000 / 60);\n    }) : function () {};\n\nexport class ScrollTip extends Component {\n\n    constructor(...args) {\n        super(...args);\n        this.state = {\n            show: true\n        };\n        this.onScroll = this.onScroll.bind(this);\n        this.onClick = this.onClick.bind(this);\n        this.loop = this.loop.bind(this);\n        this.done = this.done.bind(this);\n\n        this.timeStart = null;\n        this.distance = null;\n    }\n\n    componentDidMount() {\n        this.distance = this.props.distance * document.getElementsByTagName('html')[0].clientWidth / WINDOW_WIDTH;\n        document.addEventListener('scroll', this.onScroll);\n    }\n\n    componentWillReceiveProps(nextProps) {\n        if (nextProps.distance !== this.distance) {\n            this.distance = nextProps.distance * document.getElementsByTagName('html')[0].clientWidth / WINDOW_WIDTH;\n        }\n    }\n\n    componentWillUnmount() {\n        this.removeEvent();\n    }\n\n    removeEvent() {\n        document.removeEventListener('scroll', this.onScroll);\n    }\n\n    onScroll(e) {\n        const scrollTop = document.documentElement.scrollTop || document.body.scrollTop;\n        if (scrollTop > 100) {\n            this.setState({show: false});\n            this.removeEvent();\n        }\n    }\n\n    done() {\n        window.scrollTo(0, this.distance);\n        this.setState({show: false});\n    }\n\n    loop(timeCurrent) {\n        if (!this.timeStart) {\n            this.timeStart = timeCurrent;\n        }\n\n        const duration = 300 * (1 - this.startY / this.distance);\n\n        // determine time spent scrolling so far\n        const timeElapsed = timeCurrent - this.timeStart;\n\n        // calculate next scroll position\n        const next = easeInOutQuad(timeElapsed, this.startY, this.distance - this.startY, duration);\n\n        // scroll to it\n        window.scrollTo(0, next);\n\n        // check progress\n        timeElapsed < duration\n          ? raf(this.loop)       // continue scroll loop\n          : this.done();\n    }\n\n    onClick(e) {\n        this.startY = document.documentElement.scrollTop || document.body.scrollTop;\n        if (this.startY > this.distance) {\n            return;\n        }\n        raf(this.loop);\n    }\n\n    render() {\n\n        let {\n            className = null,\n            style = null,\n            color,\n            text,\n            height,\n            fontSize,\n            clickScroll\n        } = this.props;\n\n        return (\n            <div\n                className={cx('mola-scroll-tip', className, {'state-show': this.state.show})}\n                onClick={clickScroll ? this.onClick : null}\n                style={{\n                    ...style,\n                    color,\n                    fontSize: `${fontSize}px`,\n                    height: px2rem(height),\n                    lineHeight: px2rem(height)\n                }}>\n                <p>\n                    <span>{text}</span>\n                    <i style={{borderTopColor: color}}></i>\n                </p>\n            </div>\n        );\n    }\n\n}\n\nScrollTip.displayName = type;\n\nScrollTip.propTypes = {\n    height: PropTypes.oneOfType([PropTypes.number, PropTypes.string]).isRequired,\n    color: PropTypes.string.isRequired,\n    text: PropTypes.string.isRequired,\n    fontSize: PropTypes.oneOfType([PropTypes.number, PropTypes.string]).isRequired,\n    clickScroll: PropTypes.bool.isRequired\n};\n\nScrollTip.defaultProps = {\n    color: '#fff',\n    text: '滑动查看',\n    height: '50',\n    fontSize: '14',\n    clickScroll: false,\n    distance: '200'\n};\n\nexport default registerComponent(type, level)(ScrollTip);\n"]}